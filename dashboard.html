<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>仪表盘</title>
	<link rel="stylesheet" type="text/css" href="./assets/css/bootstrap.min.css">
	<script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
	<script src="./assets/js/jquery-3.4.1.min.js"></script>
	<script>if (window.module) module = window.module;</script>
</head>

<body>
 	<div>
		<!--改变字体大小-->
		<div class="input-group">
			<label for="">字体大小</label>
			<input type="number"
				   onkeyup="if (/(\-|\D)/g.test(this.value)) this.value = this.value.replace(/(\-|\D)/g,'')"
				   id="fontSizeInput" class="form-control"  placeholder="添加字体大小" aria-label="change word size" aria-describedby="button-addon4">
			<div class="input-group-append" id="button-addon4">
				<button class="btn btn-outline-secondary" type="button" id="changeWordSizeButtonAdd">+</button>
				<button class="btn btn-outline-secondary" type="button" id="changeWordSizeButtonDel">-</button>
			</div>
		</div>
		<!--改变刷新的时间间隔-->
		<div class="input-group mb-3">
			<label>刷新的时间间隔</label>
			<input type="number" id="timer" class="form-control" placeholder="1000" aria-label="Recipient's username" aria-describedby="button-addon2">
			<div class="input-group-append" id="button-addon3">
				<button class="btn btn-outline-secondary" type="button" id="timerAdd">+</button>
				<button class="btn btn-outline-secondary" type="button" id="timerDel">-</button>
			</div>
		</div>
 	</div>
</body>


<script src="./assets/js/popper.min.js"></script>
<script src="./assets/js/bootstrap.min.js" defer></script>
<script src="./util.js"></script>
<script type="text/javascript">
	//初始化配仪表盘页面
    setTimeout(()=>{
        // 设置字体大小
        const wordkit = getConfig()
        var fontSize = wordkit["fontSize"] ? wordkit['fontSize'] : 36
		$("#fontSizeInput").val(fontSize)

        var timer = wordkit["timer"] ? wordkit['timer'] : 3000
        $("#timer").val(timer)

    },500)


	//监听字体大小变化
	$('#changeWordSizeButtonAdd').click(() => {
	    const val = parseInt($("#fontSizeInput").val())
		const ans = val + 1 > 100 ? 100 : val + 1
        $("#fontSizeInput").val(ans)
        setConfig('fontSize',ans)
        sendMsgBetweenRender('Change Font Size',ans)
	})
    $('#changeWordSizeButtonDel').click(() => {
        const val = parseInt($("#fontSizeInput").val())
        const ans = val - 1 > 0 ? val -1 :0
        $("#fontSizeInput").val(ans)
        setConfig('fontSize',ans)
        sendMsgBetweenRender('Change Font Size',ans)
    })
	$("#fontSizeInput").blur(()=>{
        const val = parseInt($("#fontSizeInput").val())
		if(isNaN(val)) {
            $("#fontSizeInput").val(getConfig('fontSize'))
		} else {
            let ans = val > 100 ? 100 : val
            ans = val > 0 ? val : 0
            $("#fontSizeInput").val(ans)
            setConfig('fontSize',ans)
            sendMsgBetweenRender('Change Font Size',ans)
		}
		console.log(val)
	})

	//监听刷新时间间隔变化
	$("#timerAdd").click(()=>{
        const val = parseInt($("#timer").val())
        const ans = val + 500
        $("#timer").val(ans)
        setConfig('timer',ans)
        sendMsgBetweenRender('Change Timer',ans)
    })
    $("#timerDel").click(()=>{
        const val = parseInt($("#timer").val())
        const ans = val - 500 >= 1000 ? val - 500 : 1000
        $("#timer").val(ans)
        setConfig('timer',ans)
        sendMsgBetweenRender('Change Timer',ans)
    })

</script>
</html>
